using ILGPU;
using System.Numerics;
using System.Runtime.CompilerServices;

namespace GpuTest.Utils
{
    public static class Median81
    {

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        static T min<T>(T a, T b) where T : struct, INumber<T> => a < b ? a : b;

        [MethodImpl(MethodImplOptions.AggressiveInlining)]
        static T max<T>(T a, T b) where T : struct, INumber<T> => a > b ? a : b;

        [MethodImpl(MethodImplOptions.NoInlining)]
        public static T median<T>(ArrayView<T> array)
           where T : unmanaged, INumber<T>
        {
            T tmp = step1(array);
            tmp = step2(tmp, array);
            tmp = step3(tmp, array);
            tmp = step4(tmp, array);
            tmp = step5(tmp, array);
            tmp = step6(tmp, array);
            tmp = step7(tmp, array);
            return step8(tmp, array);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step1<T>(ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            T tmp = min(array[0], array[64]);
            array[64] = max(array[0], array[64]);
            array[0] = tmp;
            tmp = min(array[1], array[65]);
            array[65] = max(array[1], array[65]);
            array[1] = tmp;
            tmp = min(array[2], array[66]);
            array[66] = max(array[2], array[66]);
            array[2] = tmp;
            tmp = min(array[3], array[67]);
            array[67] = max(array[3], array[67]);
            array[3] = tmp;
            tmp = min(array[4], array[68]);
            array[68] = max(array[4], array[68]);
            array[4] = tmp;
            tmp = min(array[5], array[69]);
            array[69] = max(array[5], array[69]);
            array[5] = tmp;
            tmp = min(array[6], array[70]);
            array[70] = max(array[6], array[70]);
            array[6] = tmp;
            tmp = min(array[7], array[71]);
            array[71] = max(array[7], array[71]);
            array[7] = tmp;
            tmp = min(array[8], array[72]);
            array[72] = max(array[8], array[72]);
            array[8] = tmp;
            tmp = min(array[9], array[73]);
            array[73] = max(array[9], array[73]);
            array[9] = tmp;
            tmp = min(array[10], array[74]);
            array[74] = max(array[10], array[74]);
            array[10] = tmp;
            tmp = min(array[11], array[75]);
            array[75] = max(array[11], array[75]);
            array[11] = tmp;
            tmp = min(array[12], array[76]);
            array[76] = max(array[12], array[76]);
            array[12] = tmp;
            tmp = min(array[13], array[77]);
            array[77] = max(array[13], array[77]);
            array[13] = tmp;
            tmp = min(array[14], array[78]);
            array[78] = max(array[14], array[78]);
            array[14] = tmp;
            tmp = min(array[15], array[79]);
            array[79] = max(array[15], array[79]);
            array[15] = tmp;
            tmp = min(array[16], array[80]);
            array[80] = max(array[16], array[80]);
            array[16] = tmp;
            tmp = min(array[0], array[32]);
            array[32] = max(array[0], array[32]);
            array[0] = tmp;
            tmp = min(array[1], array[33]);
            array[33] = max(array[1], array[33]);
            array[1] = tmp;
            tmp = min(array[2], array[34]);
            array[34] = max(array[2], array[34]);
            array[2] = tmp;
            tmp = min(array[3], array[35]);
            array[35] = max(array[3], array[35]);
            array[3] = tmp;
            tmp = min(array[4], array[36]);
            array[36] = max(array[4], array[36]);
            array[4] = tmp;
            tmp = min(array[5], array[37]);
            array[37] = max(array[5], array[37]);
            array[5] = tmp;
            tmp = min(array[6], array[38]);
            array[38] = max(array[6], array[38]);
            array[6] = tmp;
            tmp = min(array[7], array[39]);
            array[39] = max(array[7], array[39]);
            array[7] = tmp;
            tmp = min(array[8], array[40]);
            array[40] = max(array[8], array[40]);
            array[8] = tmp;
            tmp = min(array[9], array[41]);
            array[41] = max(array[9], array[41]);
            array[9] = tmp;
            tmp = min(array[10], array[42]);
            array[42] = max(array[10], array[42]);
            array[10] = tmp;
            tmp = min(array[11], array[43]);
            array[43] = max(array[11], array[43]);
            array[11] = tmp;
            tmp = min(array[12], array[44]);
            array[44] = max(array[12], array[44]);
            array[12] = tmp;
            tmp = min(array[13], array[45]);
            array[45] = max(array[13], array[45]);
            array[13] = tmp;
            tmp = min(array[14], array[46]);
            array[46] = max(array[14], array[46]);
            array[14] = tmp;
            tmp = min(array[15], array[47]);
            array[47] = max(array[15], array[47]);
            array[15] = tmp;
            tmp = min(array[16], array[48]);
            array[48] = max(array[16], array[48]);
            array[16] = tmp;
            tmp = min(array[17], array[49]);
            array[49] = max(array[17], array[49]);
            array[17] = tmp;
            tmp = min(array[18], array[50]);
            array[50] = max(array[18], array[50]);
            array[18] = tmp;
            tmp = min(array[19], array[51]);
            array[51] = max(array[19], array[51]);
            array[19] = tmp;
            tmp = min(array[20], array[52]);
            array[52] = max(array[20], array[52]);
            array[20] = tmp;
            tmp = min(array[21], array[53]);
            array[53] = max(array[21], array[53]);
            array[21] = tmp;
            tmp = min(array[22], array[54]);
            array[54] = max(array[22], array[54]);
            array[22] = tmp;
            tmp = min(array[23], array[55]);
            array[55] = max(array[23], array[55]);
            array[23] = tmp;
            tmp = min(array[24], array[56]);
            array[56] = max(array[24], array[56]);
            array[24] = tmp;
            tmp = min(array[25], array[57]);
            array[57] = max(array[25], array[57]);
            array[25] = tmp;
            tmp = min(array[26], array[58]);
            array[58] = max(array[26], array[58]);
            array[26] = tmp;
            tmp = min(array[27], array[59]);
            array[59] = max(array[27], array[59]);
            array[27] = tmp;
            tmp = min(array[28], array[60]);
            array[60] = max(array[28], array[60]);
            array[28] = tmp;
            tmp = min(array[29], array[61]);
            array[61] = max(array[29], array[61]);
            array[29] = tmp;
            tmp = min(array[30], array[62]);
            array[62] = max(array[30], array[62]);
            array[30] = tmp;
            tmp = min(array[31], array[63]);
            array[63] = max(array[31], array[63]);
            array[31] = tmp;
            tmp = min(array[32], array[64]);
            array[64] = max(array[32], array[64]);
            array[32] = tmp;
            tmp = min(array[33], array[65]);
            array[65] = max(array[33], array[65]);
            array[33] = tmp;
            tmp = min(array[34], array[66]);
            array[66] = max(array[34], array[66]);
            array[34] = tmp;
            tmp = min(array[35], array[67]);
            array[67] = max(array[35], array[67]);
            array[35] = tmp;
            tmp = min(array[36], array[68]);
            array[68] = max(array[36], array[68]);
            array[36] = tmp;
            tmp = min(array[37], array[69]);
            array[69] = max(array[37], array[69]);
            array[37] = tmp;
            tmp = min(array[38], array[70]);
            array[70] = max(array[38], array[70]);
            array[38] = tmp;
            tmp = min(array[39], array[71]);
            array[71] = max(array[39], array[71]);
            array[39] = tmp;
            tmp = min(array[40], array[72]);
            array[72] = max(array[40], array[72]);
            array[40] = tmp;
            tmp = min(array[41], array[73]);
            array[73] = max(array[41], array[73]);
            array[41] = tmp;
            tmp = min(array[42], array[74]);
            array[74] = max(array[42], array[74]);
            array[42] = tmp;
            tmp = min(array[43], array[75]);
            array[75] = max(array[43], array[75]);
            array[43] = tmp;
            tmp = min(array[44], array[76]);
            array[76] = max(array[44], array[76]);
            array[44] = tmp;
            tmp = min(array[45], array[77]);
            array[77] = max(array[45], array[77]);
            array[45] = tmp;
            tmp = min(array[46], array[78]);
            array[78] = max(array[46], array[78]);
            array[46] = tmp;
            tmp = min(array[47], array[79]);
            array[79] = max(array[47], array[79]);
            array[47] = tmp;
            tmp = min(array[48], array[80]);
            array[80] = max(array[48], array[80]);
            array[48] = tmp;
            tmp = min(array[0], array[16]);
            array[16] = max(array[0], array[16]);
            array[0] = tmp;
            tmp = min(array[1], array[17]);
            array[17] = max(array[1], array[17]);
            array[1] = tmp;
            return min(array[2], array[18]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step2<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[18] = max(array[2], array[18]);
            array[2] = tmp;
            tmp = min(array[3], array[19]);
            array[19] = max(array[3], array[19]);
            array[3] = tmp;
            tmp = min(array[4], array[20]);
            array[20] = max(array[4], array[20]);
            array[4] = tmp;
            tmp = min(array[5], array[21]);
            array[21] = max(array[5], array[21]);
            array[5] = tmp;
            tmp = min(array[6], array[22]);
            array[22] = max(array[6], array[22]);
            array[6] = tmp;
            tmp = min(array[7], array[23]);
            array[23] = max(array[7], array[23]);
            array[7] = tmp;
            tmp = min(array[8], array[24]);
            array[24] = max(array[8], array[24]);
            array[8] = tmp;
            tmp = min(array[9], array[25]);
            array[25] = max(array[9], array[25]);
            array[9] = tmp;
            tmp = min(array[10], array[26]);
            array[26] = max(array[10], array[26]);
            array[10] = tmp;
            tmp = min(array[11], array[27]);
            array[27] = max(array[11], array[27]);
            array[11] = tmp;
            tmp = min(array[12], array[28]);
            array[28] = max(array[12], array[28]);
            array[12] = tmp;
            tmp = min(array[13], array[29]);
            array[29] = max(array[13], array[29]);
            array[13] = tmp;
            tmp = min(array[14], array[30]);
            array[30] = max(array[14], array[30]);
            array[14] = tmp;
            tmp = min(array[15], array[31]);
            array[31] = max(array[15], array[31]);
            array[15] = tmp;
            tmp = min(array[32], array[48]);
            array[48] = max(array[32], array[48]);
            array[32] = tmp;
            tmp = min(array[33], array[49]);
            array[49] = max(array[33], array[49]);
            array[33] = tmp;
            tmp = min(array[34], array[50]);
            array[50] = max(array[34], array[50]);
            array[34] = tmp;
            tmp = min(array[35], array[51]);
            array[51] = max(array[35], array[51]);
            array[35] = tmp;
            tmp = min(array[36], array[52]);
            array[52] = max(array[36], array[52]);
            array[36] = tmp;
            tmp = min(array[37], array[53]);
            array[53] = max(array[37], array[53]);
            array[37] = tmp;
            tmp = min(array[38], array[54]);
            array[54] = max(array[38], array[54]);
            array[38] = tmp;
            tmp = min(array[39], array[55]);
            array[55] = max(array[39], array[55]);
            array[39] = tmp;
            tmp = min(array[40], array[56]);
            array[56] = max(array[40], array[56]);
            array[40] = tmp;
            tmp = min(array[41], array[57]);
            array[57] = max(array[41], array[57]);
            array[41] = tmp;
            tmp = min(array[42], array[58]);
            array[58] = max(array[42], array[58]);
            array[42] = tmp;
            tmp = min(array[43], array[59]);
            array[59] = max(array[43], array[59]);
            array[43] = tmp;
            tmp = min(array[44], array[60]);
            array[60] = max(array[44], array[60]);
            array[44] = tmp;
            tmp = min(array[45], array[61]);
            array[61] = max(array[45], array[61]);
            array[45] = tmp;
            tmp = min(array[46], array[62]);
            array[62] = max(array[46], array[62]);
            array[46] = tmp;
            tmp = min(array[47], array[63]);
            array[63] = max(array[47], array[63]);
            array[47] = tmp;
            tmp = min(array[64], array[80]);
            array[80] = max(array[64], array[80]);
            array[64] = tmp;
            tmp = min(array[16], array[64]);
            array[64] = max(array[16], array[64]);
            array[16] = tmp;
            tmp = min(array[17], array[65]);
            array[65] = max(array[17], array[65]);
            array[17] = tmp;
            tmp = min(array[18], array[66]);
            array[66] = max(array[18], array[66]);
            array[18] = tmp;
            tmp = min(array[19], array[67]);
            array[67] = max(array[19], array[67]);
            array[19] = tmp;
            tmp = min(array[20], array[68]);
            array[68] = max(array[20], array[68]);
            array[20] = tmp;
            tmp = min(array[21], array[69]);
            array[69] = max(array[21], array[69]);
            array[21] = tmp;
            tmp = min(array[22], array[70]);
            array[70] = max(array[22], array[70]);
            array[22] = tmp;
            tmp = min(array[23], array[71]);
            array[71] = max(array[23], array[71]);
            array[23] = tmp;
            tmp = min(array[24], array[72]);
            array[72] = max(array[24], array[72]);
            array[24] = tmp;
            tmp = min(array[25], array[73]);
            array[73] = max(array[25], array[73]);
            array[25] = tmp;
            tmp = min(array[26], array[74]);
            array[74] = max(array[26], array[74]);
            array[26] = tmp;
            tmp = min(array[27], array[75]);
            array[75] = max(array[27], array[75]);
            array[27] = tmp;
            tmp = min(array[28], array[76]);
            array[76] = max(array[28], array[76]);
            array[28] = tmp;
            tmp = min(array[29], array[77]);
            array[77] = max(array[29], array[77]);
            array[29] = tmp;
            tmp = min(array[30], array[78]);
            array[78] = max(array[30], array[78]);
            array[30] = tmp;
            tmp = min(array[31], array[79]);
            array[79] = max(array[31], array[79]);
            array[31] = tmp;
            tmp = min(array[16], array[32]);
            array[32] = max(array[16], array[32]);
            array[16] = tmp;
            tmp = min(array[17], array[33]);
            array[33] = max(array[17], array[33]);
            array[17] = tmp;
            tmp = min(array[18], array[34]);
            array[34] = max(array[18], array[34]);
            array[18] = tmp;
            tmp = min(array[19], array[35]);
            array[35] = max(array[19], array[35]);
            array[19] = tmp;
            tmp = min(array[20], array[36]);
            array[36] = max(array[20], array[36]);
            array[20] = tmp;
            tmp = min(array[21], array[37]);
            array[37] = max(array[21], array[37]);
            array[21] = tmp;
            tmp = min(array[22], array[38]);
            array[38] = max(array[22], array[38]);
            array[22] = tmp;
            tmp = min(array[23], array[39]);
            array[39] = max(array[23], array[39]);
            array[23] = tmp;
            tmp = min(array[24], array[40]);
            array[40] = max(array[24], array[40]);
            array[24] = tmp;
            tmp = min(array[25], array[41]);
            array[41] = max(array[25], array[41]);
            array[25] = tmp;
            tmp = min(array[26], array[42]);
            array[42] = max(array[26], array[42]);
            array[26] = tmp;
            tmp = min(array[27], array[43]);
            array[43] = max(array[27], array[43]);
            array[27] = tmp;
            tmp = min(array[28], array[44]);
            array[44] = max(array[28], array[44]);
            array[28] = tmp;
            tmp = min(array[29], array[45]);
            array[45] = max(array[29], array[45]);
            array[29] = tmp;
            tmp = min(array[30], array[46]);
            array[46] = max(array[30], array[46]);
            array[30] = tmp;
            tmp = min(array[31], array[47]);
            array[47] = max(array[31], array[47]);
            array[31] = tmp;
            tmp = min(array[48], array[64]);
            array[64] = max(array[48], array[64]);
            array[48] = tmp;
            tmp = min(array[49], array[65]);
            array[65] = max(array[49], array[65]);
            array[49] = tmp;
            tmp = min(array[50], array[66]);
            array[66] = max(array[50], array[66]);
            array[50] = tmp;
            tmp = min(array[51], array[67]);
            array[67] = max(array[51], array[67]);
            array[51] = tmp;
            tmp = min(array[52], array[68]);
            array[68] = max(array[52], array[68]);
            array[52] = tmp;
            tmp = min(array[53], array[69]);
            array[69] = max(array[53], array[69]);
            array[53] = tmp;
            tmp = min(array[54], array[70]);
            array[70] = max(array[54], array[70]);
            array[54] = tmp;
            tmp = min(array[55], array[71]);
            array[71] = max(array[55], array[71]);
            array[55] = tmp;
            tmp = min(array[56], array[72]);
            array[72] = max(array[56], array[72]);
            array[56] = tmp;
            tmp = min(array[57], array[73]);
            array[73] = max(array[57], array[73]);
            array[57] = tmp;
            tmp = min(array[58], array[74]);
            array[74] = max(array[58], array[74]);
            array[58] = tmp;
            tmp = min(array[59], array[75]);
            array[75] = max(array[59], array[75]);
            array[59] = tmp;
            tmp = min(array[60], array[76]);
            array[76] = max(array[60], array[76]);
            array[60] = tmp;
            tmp = min(array[61], array[77]);
            array[77] = max(array[61], array[77]);
            array[61] = tmp;
            tmp = min(array[62], array[78]);
            array[78] = max(array[62], array[78]);
            array[62] = tmp;
            tmp = min(array[63], array[79]);
            array[79] = max(array[63], array[79]);
            array[63] = tmp;
            tmp = min(array[0], array[8]);
            array[8] = max(array[0], array[8]);
            array[0] = tmp;
            tmp = min(array[1], array[9]);
            array[9] = max(array[1], array[9]);
            array[1] = tmp;
            tmp = min(array[2], array[10]);
            array[10] = max(array[2], array[10]);
            array[2] = tmp;
            return min(array[3], array[11]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step3<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[11] = max(array[3], array[11]);
            array[3] = tmp;
            tmp = min(array[4], array[12]);
            array[12] = max(array[4], array[12]);
            array[4] = tmp;
            tmp = min(array[5], array[13]);
            array[13] = max(array[5], array[13]);
            array[5] = tmp;
            tmp = min(array[6], array[14]);
            array[14] = max(array[6], array[14]);
            array[6] = tmp;
            tmp = min(array[7], array[15]);
            array[15] = max(array[7], array[15]);
            array[7] = tmp;
            tmp = min(array[16], array[24]);
            array[24] = max(array[16], array[24]);
            array[16] = tmp;
            tmp = min(array[17], array[25]);
            array[25] = max(array[17], array[25]);
            array[17] = tmp;
            tmp = min(array[18], array[26]);
            array[26] = max(array[18], array[26]);
            array[18] = tmp;
            tmp = min(array[19], array[27]);
            array[27] = max(array[19], array[27]);
            array[19] = tmp;
            tmp = min(array[20], array[28]);
            array[28] = max(array[20], array[28]);
            array[20] = tmp;
            tmp = min(array[21], array[29]);
            array[29] = max(array[21], array[29]);
            array[21] = tmp;
            tmp = min(array[22], array[30]);
            array[30] = max(array[22], array[30]);
            array[22] = tmp;
            tmp = min(array[23], array[31]);
            array[31] = max(array[23], array[31]);
            array[23] = tmp;
            tmp = min(array[32], array[40]);
            array[40] = max(array[32], array[40]);
            array[32] = tmp;
            tmp = min(array[33], array[41]);
            array[41] = max(array[33], array[41]);
            array[33] = tmp;
            tmp = min(array[34], array[42]);
            array[42] = max(array[34], array[42]);
            array[34] = tmp;
            tmp = min(array[35], array[43]);
            array[43] = max(array[35], array[43]);
            array[35] = tmp;
            tmp = min(array[36], array[44]);
            array[44] = max(array[36], array[44]);
            array[36] = tmp;
            tmp = min(array[37], array[45]);
            array[45] = max(array[37], array[45]);
            array[37] = tmp;
            tmp = min(array[38], array[46]);
            array[46] = max(array[38], array[46]);
            array[38] = tmp;
            tmp = min(array[39], array[47]);
            array[47] = max(array[39], array[47]);
            array[39] = tmp;
            tmp = min(array[48], array[56]);
            array[56] = max(array[48], array[56]);
            array[48] = tmp;
            tmp = min(array[49], array[57]);
            array[57] = max(array[49], array[57]);
            array[49] = tmp;
            tmp = min(array[50], array[58]);
            array[58] = max(array[50], array[58]);
            array[50] = tmp;
            tmp = min(array[51], array[59]);
            array[59] = max(array[51], array[59]);
            array[51] = tmp;
            tmp = min(array[52], array[60]);
            array[60] = max(array[52], array[60]);
            array[52] = tmp;
            tmp = min(array[53], array[61]);
            array[61] = max(array[53], array[61]);
            array[53] = tmp;
            tmp = min(array[54], array[62]);
            array[62] = max(array[54], array[62]);
            array[54] = tmp;
            tmp = min(array[55], array[63]);
            array[63] = max(array[55], array[63]);
            array[55] = tmp;
            tmp = min(array[64], array[72]);
            array[72] = max(array[64], array[72]);
            array[64] = tmp;
            tmp = min(array[65], array[73]);
            array[73] = max(array[65], array[73]);
            array[65] = tmp;
            tmp = min(array[66], array[74]);
            array[74] = max(array[66], array[74]);
            array[66] = tmp;
            tmp = min(array[67], array[75]);
            array[75] = max(array[67], array[75]);
            array[67] = tmp;
            tmp = min(array[68], array[76]);
            array[76] = max(array[68], array[76]);
            array[68] = tmp;
            tmp = min(array[69], array[77]);
            array[77] = max(array[69], array[77]);
            array[69] = tmp;
            tmp = min(array[70], array[78]);
            array[78] = max(array[70], array[78]);
            array[70] = tmp;
            tmp = min(array[71], array[79]);
            array[79] = max(array[71], array[79]);
            array[71] = tmp;
            tmp = min(array[8], array[64]);
            array[64] = max(array[8], array[64]);
            array[8] = tmp;
            tmp = min(array[9], array[65]);
            array[65] = max(array[9], array[65]);
            array[9] = tmp;
            tmp = min(array[10], array[66]);
            array[66] = max(array[10], array[66]);
            array[10] = tmp;
            tmp = min(array[11], array[67]);
            array[67] = max(array[11], array[67]);
            array[11] = tmp;
            tmp = min(array[12], array[68]);
            array[68] = max(array[12], array[68]);
            array[12] = tmp;
            tmp = min(array[13], array[69]);
            array[69] = max(array[13], array[69]);
            array[13] = tmp;
            tmp = min(array[14], array[70]);
            array[70] = max(array[14], array[70]);
            array[14] = tmp;
            tmp = min(array[15], array[71]);
            array[71] = max(array[15], array[71]);
            array[15] = tmp;
            tmp = min(array[24], array[80]);
            array[80] = max(array[24], array[80]);
            array[24] = tmp;
            tmp = min(array[8], array[32]);
            array[32] = max(array[8], array[32]);
            array[8] = tmp;
            tmp = min(array[9], array[33]);
            array[33] = max(array[9], array[33]);
            array[9] = tmp;
            tmp = min(array[10], array[34]);
            array[34] = max(array[10], array[34]);
            array[10] = tmp;
            tmp = min(array[11], array[35]);
            array[35] = max(array[11], array[35]);
            array[11] = tmp;
            tmp = min(array[12], array[36]);
            array[36] = max(array[12], array[36]);
            array[12] = tmp;
            tmp = min(array[13], array[37]);
            array[37] = max(array[13], array[37]);
            array[13] = tmp;
            tmp = min(array[14], array[38]);
            array[38] = max(array[14], array[38]);
            array[14] = tmp;
            tmp = min(array[15], array[39]);
            array[39] = max(array[15], array[39]);
            array[15] = tmp;
            tmp = min(array[24], array[48]);
            array[48] = max(array[24], array[48]);
            array[24] = tmp;
            tmp = min(array[25], array[49]);
            array[49] = max(array[25], array[49]);
            array[25] = tmp;
            tmp = min(array[26], array[50]);
            array[50] = max(array[26], array[50]);
            array[26] = tmp;
            tmp = min(array[27], array[51]);
            array[51] = max(array[27], array[51]);
            array[27] = tmp;
            tmp = min(array[28], array[52]);
            array[52] = max(array[28], array[52]);
            array[28] = tmp;
            tmp = min(array[29], array[53]);
            array[53] = max(array[29], array[53]);
            array[29] = tmp;
            tmp = min(array[30], array[54]);
            array[54] = max(array[30], array[54]);
            array[30] = tmp;
            tmp = min(array[31], array[55]);
            array[55] = max(array[31], array[55]);
            array[31] = tmp;
            tmp = min(array[40], array[64]);
            array[64] = max(array[40], array[64]);
            array[40] = tmp;
            tmp = min(array[41], array[65]);
            array[65] = max(array[41], array[65]);
            array[41] = tmp;
            tmp = min(array[42], array[66]);
            array[66] = max(array[42], array[66]);
            array[42] = tmp;
            tmp = min(array[43], array[67]);
            array[67] = max(array[43], array[67]);
            array[43] = tmp;
            tmp = min(array[44], array[68]);
            array[68] = max(array[44], array[68]);
            array[44] = tmp;
            tmp = min(array[45], array[69]);
            array[69] = max(array[45], array[69]);
            array[45] = tmp;
            tmp = min(array[46], array[70]);
            array[70] = max(array[46], array[70]);
            array[46] = tmp;
            tmp = min(array[47], array[71]);
            array[71] = max(array[47], array[71]);
            array[47] = tmp;
            tmp = min(array[56], array[80]);
            array[80] = max(array[56], array[80]);
            array[56] = tmp;
            tmp = min(array[8], array[16]);
            array[16] = max(array[8], array[16]);
            array[8] = tmp;
            tmp = min(array[9], array[17]);
            array[17] = max(array[9], array[17]);
            array[9] = tmp;
            tmp = min(array[10], array[18]);
            array[18] = max(array[10], array[18]);
            array[10] = tmp;
            tmp = min(array[11], array[19]);
            array[19] = max(array[11], array[19]);
            array[11] = tmp;
            tmp = min(array[12], array[20]);
            array[20] = max(array[12], array[20]);
            array[12] = tmp;
            tmp = min(array[13], array[21]);
            array[21] = max(array[13], array[21]);
            array[13] = tmp;
            tmp = min(array[14], array[22]);
            array[22] = max(array[14], array[22]);
            array[14] = tmp;
            tmp = min(array[15], array[23]);
            array[23] = max(array[15], array[23]);
            array[15] = tmp;
            return min(array[24], array[32]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step4<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[32] = max(array[24], array[32]);
            array[24] = tmp;
            tmp = min(array[25], array[33]);
            array[33] = max(array[25], array[33]);
            array[25] = tmp;
            tmp = min(array[26], array[34]);
            array[34] = max(array[26], array[34]);
            array[26] = tmp;
            tmp = min(array[27], array[35]);
            array[35] = max(array[27], array[35]);
            array[27] = tmp;
            tmp = min(array[28], array[36]);
            array[36] = max(array[28], array[36]);
            array[28] = tmp;
            tmp = min(array[29], array[37]);
            array[37] = max(array[29], array[37]);
            array[29] = tmp;
            tmp = min(array[30], array[38]);
            array[38] = max(array[30], array[38]);
            array[30] = tmp;
            tmp = min(array[31], array[39]);
            array[39] = max(array[31], array[39]);
            array[31] = tmp;
            tmp = min(array[40], array[48]);
            array[48] = max(array[40], array[48]);
            array[40] = tmp;
            tmp = min(array[41], array[49]);
            array[49] = max(array[41], array[49]);
            array[41] = tmp;
            tmp = min(array[42], array[50]);
            array[50] = max(array[42], array[50]);
            array[42] = tmp;
            tmp = min(array[43], array[51]);
            array[51] = max(array[43], array[51]);
            array[43] = tmp;
            tmp = min(array[44], array[52]);
            array[52] = max(array[44], array[52]);
            array[44] = tmp;
            tmp = min(array[45], array[53]);
            array[53] = max(array[45], array[53]);
            array[45] = tmp;
            tmp = min(array[46], array[54]);
            array[54] = max(array[46], array[54]);
            array[46] = tmp;
            tmp = min(array[47], array[55]);
            array[55] = max(array[47], array[55]);
            array[47] = tmp;
            tmp = min(array[56], array[64]);
            array[64] = max(array[56], array[64]);
            array[56] = tmp;
            tmp = min(array[57], array[65]);
            array[65] = max(array[57], array[65]);
            array[57] = tmp;
            tmp = min(array[58], array[66]);
            array[66] = max(array[58], array[66]);
            array[58] = tmp;
            tmp = min(array[59], array[67]);
            array[67] = max(array[59], array[67]);
            array[59] = tmp;
            tmp = min(array[60], array[68]);
            array[68] = max(array[60], array[68]);
            array[60] = tmp;
            tmp = min(array[61], array[69]);
            array[69] = max(array[61], array[69]);
            array[61] = tmp;
            tmp = min(array[62], array[70]);
            array[70] = max(array[62], array[70]);
            array[62] = tmp;
            tmp = min(array[63], array[71]);
            array[71] = max(array[63], array[71]);
            array[63] = tmp;
            tmp = min(array[72], array[80]);
            array[80] = max(array[72], array[80]);
            array[72] = tmp;
            tmp = min(array[0], array[4]);
            array[4] = max(array[0], array[4]);
            array[0] = tmp;
            tmp = min(array[1], array[5]);
            array[5] = max(array[1], array[5]);
            array[1] = tmp;
            tmp = min(array[2], array[6]);
            array[6] = max(array[2], array[6]);
            array[2] = tmp;
            tmp = min(array[3], array[7]);
            array[7] = max(array[3], array[7]);
            array[3] = tmp;
            tmp = min(array[8], array[12]);
            array[12] = max(array[8], array[12]);
            array[8] = tmp;
            tmp = min(array[9], array[13]);
            array[13] = max(array[9], array[13]);
            array[9] = tmp;
            tmp = min(array[10], array[14]);
            array[14] = max(array[10], array[14]);
            array[10] = tmp;
            tmp = min(array[11], array[15]);
            array[15] = max(array[11], array[15]);
            array[11] = tmp;
            tmp = min(array[16], array[20]);
            array[20] = max(array[16], array[20]);
            array[16] = tmp;
            tmp = min(array[17], array[21]);
            array[21] = max(array[17], array[21]);
            array[17] = tmp;
            tmp = min(array[18], array[22]);
            array[22] = max(array[18], array[22]);
            array[18] = tmp;
            tmp = min(array[19], array[23]);
            array[23] = max(array[19], array[23]);
            array[19] = tmp;
            tmp = min(array[24], array[28]);
            array[28] = max(array[24], array[28]);
            array[24] = tmp;
            tmp = min(array[25], array[29]);
            array[29] = max(array[25], array[29]);
            array[25] = tmp;
            tmp = min(array[26], array[30]);
            array[30] = max(array[26], array[30]);
            array[26] = tmp;
            tmp = min(array[27], array[31]);
            array[31] = max(array[27], array[31]);
            array[27] = tmp;
            tmp = min(array[32], array[36]);
            array[36] = max(array[32], array[36]);
            array[32] = tmp;
            tmp = min(array[33], array[37]);
            array[37] = max(array[33], array[37]);
            array[33] = tmp;
            tmp = min(array[34], array[38]);
            array[38] = max(array[34], array[38]);
            array[34] = tmp;
            tmp = min(array[35], array[39]);
            array[39] = max(array[35], array[39]);
            array[35] = tmp;
            tmp = min(array[40], array[44]);
            array[44] = max(array[40], array[44]);
            array[40] = tmp;
            tmp = min(array[41], array[45]);
            array[45] = max(array[41], array[45]);
            array[41] = tmp;
            tmp = min(array[42], array[46]);
            array[46] = max(array[42], array[46]);
            array[42] = tmp;
            tmp = min(array[43], array[47]);
            array[47] = max(array[43], array[47]);
            array[43] = tmp;
            tmp = min(array[48], array[52]);
            array[52] = max(array[48], array[52]);
            array[48] = tmp;
            tmp = min(array[49], array[53]);
            array[53] = max(array[49], array[53]);
            array[49] = tmp;
            tmp = min(array[50], array[54]);
            array[54] = max(array[50], array[54]);
            array[50] = tmp;
            tmp = min(array[51], array[55]);
            array[55] = max(array[51], array[55]);
            array[51] = tmp;
            tmp = min(array[56], array[60]);
            array[60] = max(array[56], array[60]);
            array[56] = tmp;
            tmp = min(array[57], array[61]);
            array[61] = max(array[57], array[61]);
            array[57] = tmp;
            tmp = min(array[58], array[62]);
            array[62] = max(array[58], array[62]);
            array[58] = tmp;
            tmp = min(array[59], array[63]);
            array[63] = max(array[59], array[63]);
            array[59] = tmp;
            tmp = min(array[64], array[68]);
            array[68] = max(array[64], array[68]);
            array[64] = tmp;
            tmp = min(array[65], array[69]);
            array[69] = max(array[65], array[69]);
            array[65] = tmp;
            tmp = min(array[66], array[70]);
            array[70] = max(array[66], array[70]);
            array[66] = tmp;
            tmp = min(array[67], array[71]);
            array[71] = max(array[67], array[71]);
            array[67] = tmp;
            tmp = min(array[72], array[76]);
            array[76] = max(array[72], array[76]);
            array[72] = tmp;
            tmp = min(array[73], array[77]);
            array[77] = max(array[73], array[77]);
            array[73] = tmp;
            tmp = min(array[74], array[78]);
            array[78] = max(array[74], array[78]);
            array[74] = tmp;
            tmp = min(array[75], array[79]);
            array[79] = max(array[75], array[79]);
            array[75] = tmp;
            tmp = min(array[4], array[64]);
            array[64] = max(array[4], array[64]);
            array[4] = tmp;
            tmp = min(array[5], array[65]);
            array[65] = max(array[5], array[65]);
            array[5] = tmp;
            tmp = min(array[6], array[66]);
            array[66] = max(array[6], array[66]);
            array[6] = tmp;
            tmp = min(array[7], array[67]);
            array[67] = max(array[7], array[67]);
            array[7] = tmp;
            tmp = min(array[12], array[72]);
            array[72] = max(array[12], array[72]);
            array[12] = tmp;
            tmp = min(array[13], array[73]);
            array[73] = max(array[13], array[73]);
            array[13] = tmp;
            tmp = min(array[14], array[74]);
            array[74] = max(array[14], array[74]);
            array[14] = tmp;
            tmp = min(array[15], array[75]);
            array[75] = max(array[15], array[75]);
            array[15] = tmp;
            tmp = min(array[20], array[80]);
            array[80] = max(array[20], array[80]);
            array[20] = tmp;
            tmp = min(array[4], array[32]);
            array[32] = max(array[4], array[32]);
            array[4] = tmp;
            tmp = min(array[5], array[33]);
            array[33] = max(array[5], array[33]);
            array[5] = tmp;
            tmp = min(array[6], array[34]);
            array[34] = max(array[6], array[34]);
            array[6] = tmp;
            tmp = min(array[7], array[35]);
            array[35] = max(array[7], array[35]);
            array[7] = tmp;
            tmp = min(array[12], array[40]);
            array[40] = max(array[12], array[40]);
            array[12] = tmp;
            tmp = min(array[13], array[41]);
            array[41] = max(array[13], array[41]);
            array[13] = tmp;
            return min(array[14], array[42]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step5<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[42] = max(array[14], array[42]);
            array[14] = tmp;
            tmp = min(array[15], array[43]);
            array[43] = max(array[15], array[43]);
            array[15] = tmp;
            tmp = min(array[20], array[48]);
            array[48] = max(array[20], array[48]);
            array[20] = tmp;
            tmp = min(array[21], array[49]);
            array[49] = max(array[21], array[49]);
            array[21] = tmp;
            tmp = min(array[22], array[50]);
            array[50] = max(array[22], array[50]);
            array[22] = tmp;
            tmp = min(array[23], array[51]);
            array[51] = max(array[23], array[51]);
            array[23] = tmp;
            tmp = min(array[28], array[56]);
            array[56] = max(array[28], array[56]);
            array[28] = tmp;
            tmp = min(array[29], array[57]);
            array[57] = max(array[29], array[57]);
            array[29] = tmp;
            tmp = min(array[30], array[58]);
            array[58] = max(array[30], array[58]);
            array[30] = tmp;
            tmp = min(array[31], array[59]);
            array[59] = max(array[31], array[59]);
            array[31] = tmp;
            tmp = min(array[36], array[64]);
            array[64] = max(array[36], array[64]);
            array[36] = tmp;
            tmp = min(array[37], array[65]);
            array[65] = max(array[37], array[65]);
            array[37] = tmp;
            tmp = min(array[38], array[66]);
            array[66] = max(array[38], array[66]);
            array[38] = tmp;
            tmp = min(array[39], array[67]);
            array[67] = max(array[39], array[67]);
            array[39] = tmp;
            tmp = min(array[44], array[72]);
            array[72] = max(array[44], array[72]);
            array[44] = tmp;
            tmp = min(array[45], array[73]);
            array[73] = max(array[45], array[73]);
            array[45] = tmp;
            tmp = min(array[46], array[74]);
            array[74] = max(array[46], array[74]);
            array[46] = tmp;
            tmp = min(array[47], array[75]);
            array[75] = max(array[47], array[75]);
            array[47] = tmp;
            tmp = min(array[52], array[80]);
            array[80] = max(array[52], array[80]);
            array[52] = tmp;
            tmp = min(array[4], array[16]);
            array[16] = max(array[4], array[16]);
            array[4] = tmp;
            tmp = min(array[5], array[17]);
            array[17] = max(array[5], array[17]);
            array[5] = tmp;
            tmp = min(array[6], array[18]);
            array[18] = max(array[6], array[18]);
            array[6] = tmp;
            tmp = min(array[7], array[19]);
            array[19] = max(array[7], array[19]);
            array[7] = tmp;
            tmp = min(array[12], array[24]);
            array[24] = max(array[12], array[24]);
            array[12] = tmp;
            tmp = min(array[13], array[25]);
            array[25] = max(array[13], array[25]);
            array[13] = tmp;
            tmp = min(array[14], array[26]);
            array[26] = max(array[14], array[26]);
            array[14] = tmp;
            tmp = min(array[15], array[27]);
            array[27] = max(array[15], array[27]);
            array[15] = tmp;
            tmp = min(array[20], array[32]);
            array[32] = max(array[20], array[32]);
            array[20] = tmp;
            tmp = min(array[21], array[33]);
            array[33] = max(array[21], array[33]);
            array[21] = tmp;
            tmp = min(array[22], array[34]);
            array[34] = max(array[22], array[34]);
            array[22] = tmp;
            tmp = min(array[23], array[35]);
            array[35] = max(array[23], array[35]);
            array[23] = tmp;
            tmp = min(array[28], array[40]);
            array[40] = max(array[28], array[40]);
            array[28] = tmp;
            tmp = min(array[29], array[41]);
            array[41] = max(array[29], array[41]);
            array[29] = tmp;
            tmp = min(array[30], array[42]);
            array[42] = max(array[30], array[42]);
            array[30] = tmp;
            tmp = min(array[31], array[43]);
            array[43] = max(array[31], array[43]);
            array[31] = tmp;
            tmp = min(array[36], array[48]);
            array[48] = max(array[36], array[48]);
            array[36] = tmp;
            tmp = min(array[37], array[49]);
            array[49] = max(array[37], array[49]);
            array[37] = tmp;
            tmp = min(array[38], array[50]);
            array[50] = max(array[38], array[50]);
            array[38] = tmp;
            tmp = min(array[39], array[51]);
            array[51] = max(array[39], array[51]);
            array[39] = tmp;
            tmp = min(array[44], array[56]);
            array[56] = max(array[44], array[56]);
            array[44] = tmp;
            tmp = min(array[45], array[57]);
            array[57] = max(array[45], array[57]);
            array[45] = tmp;
            tmp = min(array[46], array[58]);
            array[58] = max(array[46], array[58]);
            array[46] = tmp;
            tmp = min(array[47], array[59]);
            array[59] = max(array[47], array[59]);
            array[47] = tmp;
            tmp = min(array[52], array[64]);
            array[64] = max(array[52], array[64]);
            array[52] = tmp;
            tmp = min(array[53], array[65]);
            array[65] = max(array[53], array[65]);
            array[53] = tmp;
            tmp = min(array[54], array[66]);
            array[66] = max(array[54], array[66]);
            array[54] = tmp;
            tmp = min(array[55], array[67]);
            array[67] = max(array[55], array[67]);
            array[55] = tmp;
            tmp = min(array[60], array[72]);
            array[72] = max(array[60], array[72]);
            array[60] = tmp;
            tmp = min(array[61], array[73]);
            array[73] = max(array[61], array[73]);
            array[61] = tmp;
            tmp = min(array[62], array[74]);
            array[74] = max(array[62], array[74]);
            array[62] = tmp;
            tmp = min(array[63], array[75]);
            array[75] = max(array[63], array[75]);
            array[63] = tmp;
            tmp = min(array[68], array[80]);
            array[80] = max(array[68], array[80]);
            array[68] = tmp;
            tmp = min(array[4], array[8]);
            array[8] = max(array[4], array[8]);
            array[4] = tmp;
            tmp = min(array[5], array[9]);
            array[9] = max(array[5], array[9]);
            array[5] = tmp;
            tmp = min(array[6], array[10]);
            array[10] = max(array[6], array[10]);
            array[6] = tmp;
            tmp = min(array[7], array[11]);
            array[11] = max(array[7], array[11]);
            array[7] = tmp;
            tmp = min(array[12], array[16]);
            array[16] = max(array[12], array[16]);
            array[12] = tmp;
            tmp = min(array[13], array[17]);
            array[17] = max(array[13], array[17]);
            array[13] = tmp;
            tmp = min(array[14], array[18]);
            array[18] = max(array[14], array[18]);
            array[14] = tmp;
            tmp = min(array[15], array[19]);
            array[19] = max(array[15], array[19]);
            array[15] = tmp;
            tmp = min(array[20], array[24]);
            array[24] = max(array[20], array[24]);
            array[20] = tmp;
            tmp = min(array[21], array[25]);
            array[25] = max(array[21], array[25]);
            array[21] = tmp;
            tmp = min(array[22], array[26]);
            array[26] = max(array[22], array[26]);
            array[22] = tmp;
            tmp = min(array[23], array[27]);
            array[27] = max(array[23], array[27]);
            array[23] = tmp;
            tmp = min(array[28], array[32]);
            array[32] = max(array[28], array[32]);
            array[28] = tmp;
            tmp = min(array[29], array[33]);
            array[33] = max(array[29], array[33]);
            array[29] = tmp;
            tmp = min(array[30], array[34]);
            array[34] = max(array[30], array[34]);
            array[30] = tmp;
            tmp = min(array[31], array[35]);
            array[35] = max(array[31], array[35]);
            array[31] = tmp;
            tmp = min(array[36], array[40]);
            array[40] = max(array[36], array[40]);
            array[36] = tmp;
            tmp = min(array[37], array[41]);
            array[41] = max(array[37], array[41]);
            array[37] = tmp;
            tmp = min(array[38], array[42]);
            array[42] = max(array[38], array[42]);
            array[38] = tmp;
            tmp = min(array[39], array[43]);
            array[43] = max(array[39], array[43]);
            array[39] = tmp;
            tmp = min(array[44], array[48]);
            array[48] = max(array[44], array[48]);
            array[44] = tmp;
            tmp = min(array[45], array[49]);
            array[49] = max(array[45], array[49]);
            array[45] = tmp;
            tmp = min(array[46], array[50]);
            array[50] = max(array[46], array[50]);
            array[46] = tmp;
            tmp = min(array[47], array[51]);
            array[51] = max(array[47], array[51]);
            array[47] = tmp;
            tmp = min(array[52], array[56]);
            array[56] = max(array[52], array[56]);
            array[52] = tmp;
            tmp = min(array[53], array[57]);
            array[57] = max(array[53], array[57]);
            array[53] = tmp;
            tmp = min(array[54], array[58]);
            array[58] = max(array[54], array[58]);
            array[54] = tmp;
            return min(array[55], array[59]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step6<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[59] = max(array[55], array[59]);
            array[55] = tmp;
            tmp = min(array[60], array[64]);
            array[64] = max(array[60], array[64]);
            array[60] = tmp;
            tmp = min(array[61], array[65]);
            array[65] = max(array[61], array[65]);
            array[61] = tmp;
            tmp = min(array[62], array[66]);
            array[66] = max(array[62], array[66]);
            array[62] = tmp;
            tmp = min(array[63], array[67]);
            array[67] = max(array[63], array[67]);
            array[63] = tmp;
            tmp = min(array[68], array[72]);
            array[72] = max(array[68], array[72]);
            array[68] = tmp;
            tmp = min(array[69], array[73]);
            array[73] = max(array[69], array[73]);
            array[69] = tmp;
            tmp = min(array[70], array[74]);
            array[74] = max(array[70], array[74]);
            array[70] = tmp;
            tmp = min(array[71], array[75]);
            array[75] = max(array[71], array[75]);
            array[71] = tmp;
            tmp = min(array[76], array[80]);
            array[80] = max(array[76], array[80]);
            array[76] = tmp;
            tmp = min(array[0], array[2]);
            array[2] = max(array[0], array[2]);
            array[0] = tmp;
            tmp = min(array[1], array[3]);
            array[3] = max(array[1], array[3]);
            array[1] = tmp;
            tmp = min(array[4], array[6]);
            array[6] = max(array[4], array[6]);
            array[4] = tmp;
            tmp = min(array[5], array[7]);
            array[7] = max(array[5], array[7]);
            array[5] = tmp;
            tmp = min(array[8], array[10]);
            array[10] = max(array[8], array[10]);
            array[8] = tmp;
            tmp = min(array[9], array[11]);
            array[11] = max(array[9], array[11]);
            array[9] = tmp;
            tmp = min(array[12], array[14]);
            array[14] = max(array[12], array[14]);
            array[12] = tmp;
            tmp = min(array[13], array[15]);
            array[15] = max(array[13], array[15]);
            array[13] = tmp;
            tmp = min(array[16], array[18]);
            array[18] = max(array[16], array[18]);
            array[16] = tmp;
            tmp = min(array[17], array[19]);
            array[19] = max(array[17], array[19]);
            array[17] = tmp;
            tmp = min(array[20], array[22]);
            array[22] = max(array[20], array[22]);
            array[20] = tmp;
            tmp = min(array[21], array[23]);
            array[23] = max(array[21], array[23]);
            array[21] = tmp;
            tmp = min(array[24], array[26]);
            array[26] = max(array[24], array[26]);
            array[24] = tmp;
            tmp = min(array[25], array[27]);
            array[27] = max(array[25], array[27]);
            array[25] = tmp;
            tmp = min(array[28], array[30]);
            array[30] = max(array[28], array[30]);
            array[28] = tmp;
            tmp = min(array[29], array[31]);
            array[31] = max(array[29], array[31]);
            array[29] = tmp;
            tmp = min(array[32], array[34]);
            array[34] = max(array[32], array[34]);
            array[32] = tmp;
            tmp = min(array[33], array[35]);
            array[35] = max(array[33], array[35]);
            array[33] = tmp;
            tmp = min(array[36], array[38]);
            array[38] = max(array[36], array[38]);
            array[36] = tmp;
            tmp = min(array[37], array[39]);
            array[39] = max(array[37], array[39]);
            array[37] = tmp;
            tmp = min(array[40], array[42]);
            array[42] = max(array[40], array[42]);
            array[40] = tmp;
            tmp = min(array[41], array[43]);
            array[43] = max(array[41], array[43]);
            array[41] = tmp;
            tmp = min(array[44], array[46]);
            array[46] = max(array[44], array[46]);
            array[44] = tmp;
            tmp = min(array[45], array[47]);
            array[47] = max(array[45], array[47]);
            array[45] = tmp;
            tmp = min(array[48], array[50]);
            array[50] = max(array[48], array[50]);
            array[48] = tmp;
            tmp = min(array[49], array[51]);
            array[51] = max(array[49], array[51]);
            array[49] = tmp;
            tmp = min(array[52], array[54]);
            array[54] = max(array[52], array[54]);
            array[52] = tmp;
            tmp = min(array[53], array[55]);
            array[55] = max(array[53], array[55]);
            array[53] = tmp;
            tmp = min(array[56], array[58]);
            array[58] = max(array[56], array[58]);
            array[56] = tmp;
            tmp = min(array[57], array[59]);
            array[59] = max(array[57], array[59]);
            array[57] = tmp;
            tmp = min(array[60], array[62]);
            array[62] = max(array[60], array[62]);
            array[60] = tmp;
            tmp = min(array[61], array[63]);
            array[63] = max(array[61], array[63]);
            array[61] = tmp;
            tmp = min(array[64], array[66]);
            array[66] = max(array[64], array[66]);
            array[64] = tmp;
            tmp = min(array[65], array[67]);
            array[67] = max(array[65], array[67]);
            array[65] = tmp;
            tmp = min(array[68], array[70]);
            array[70] = max(array[68], array[70]);
            array[68] = tmp;
            tmp = min(array[69], array[71]);
            array[71] = max(array[69], array[71]);
            array[69] = tmp;
            tmp = min(array[72], array[74]);
            array[74] = max(array[72], array[74]);
            array[72] = tmp;
            tmp = min(array[73], array[75]);
            array[75] = max(array[73], array[75]);
            array[73] = tmp;
            tmp = min(array[76], array[78]);
            array[78] = max(array[76], array[78]);
            array[76] = tmp;
            tmp = min(array[77], array[79]);
            array[79] = max(array[77], array[79]);
            array[77] = tmp;
            tmp = min(array[2], array[64]);
            array[64] = max(array[2], array[64]);
            array[2] = tmp;
            tmp = min(array[3], array[65]);
            array[65] = max(array[3], array[65]);
            array[3] = tmp;
            tmp = min(array[6], array[68]);
            array[68] = max(array[6], array[68]);
            array[6] = tmp;
            tmp = min(array[7], array[69]);
            array[69] = max(array[7], array[69]);
            array[7] = tmp;
            tmp = min(array[10], array[72]);
            array[72] = max(array[10], array[72]);
            array[10] = tmp;
            tmp = min(array[11], array[73]);
            array[73] = max(array[11], array[73]);
            array[11] = tmp;
            tmp = min(array[14], array[76]);
            array[76] = max(array[14], array[76]);
            array[14] = tmp;
            tmp = min(array[15], array[77]);
            array[77] = max(array[15], array[77]);
            array[15] = tmp;
            tmp = min(array[18], array[80]);
            array[80] = max(array[18], array[80]);
            array[18] = tmp;
            tmp = min(array[2], array[32]);
            array[32] = max(array[2], array[32]);
            array[2] = tmp;
            tmp = min(array[3], array[33]);
            array[33] = max(array[3], array[33]);
            array[3] = tmp;
            tmp = min(array[6], array[36]);
            array[36] = max(array[6], array[36]);
            array[6] = tmp;
            tmp = min(array[7], array[37]);
            array[37] = max(array[7], array[37]);
            array[7] = tmp;
            tmp = min(array[10], array[40]);
            array[40] = max(array[10], array[40]);
            array[10] = tmp;
            tmp = min(array[11], array[41]);
            array[41] = max(array[11], array[41]);
            array[11] = tmp;
            tmp = min(array[14], array[44]);
            array[44] = max(array[14], array[44]);
            array[14] = tmp;
            tmp = min(array[15], array[45]);
            array[45] = max(array[15], array[45]);
            array[15] = tmp;
            tmp = min(array[18], array[48]);
            array[48] = max(array[18], array[48]);
            array[18] = tmp;
            tmp = min(array[19], array[49]);
            array[49] = max(array[19], array[49]);
            array[19] = tmp;
            tmp = min(array[22], array[52]);
            array[52] = max(array[22], array[52]);
            array[22] = tmp;
            tmp = min(array[23], array[53]);
            array[53] = max(array[23], array[53]);
            array[23] = tmp;
            tmp = min(array[26], array[56]);
            array[56] = max(array[26], array[56]);
            array[26] = tmp;
            tmp = min(array[27], array[57]);
            array[57] = max(array[27], array[57]);
            array[27] = tmp;
            tmp = min(array[30], array[60]);
            array[60] = max(array[30], array[60]);
            array[30] = tmp;
            tmp = min(array[31], array[61]);
            array[61] = max(array[31], array[61]);
            array[31] = tmp;
            tmp = min(array[34], array[64]);
            array[64] = max(array[34], array[64]);
            array[34] = tmp;
            tmp = min(array[35], array[65]);
            array[65] = max(array[35], array[65]);
            array[35] = tmp;
            tmp = min(array[38], array[68]);
            array[68] = max(array[38], array[68]);
            array[38] = tmp;
            tmp = min(array[39], array[69]);
            array[69] = max(array[39], array[69]);
            array[39] = tmp;
            tmp = min(array[42], array[72]);
            array[72] = max(array[42], array[72]);
            array[42] = tmp;
            tmp = min(array[43], array[73]);
            array[73] = max(array[43], array[73]);
            array[43] = tmp;
            tmp = min(array[46], array[76]);
            array[76] = max(array[46], array[76]);
            array[46] = tmp;
            tmp = min(array[47], array[77]);
            array[77] = max(array[47], array[77]);
            array[47] = tmp;
            tmp = min(array[50], array[80]);
            array[80] = max(array[50], array[80]);
            array[50] = tmp;
            tmp = min(array[2], array[16]);
            array[16] = max(array[2], array[16]);
            array[2] = tmp;
            tmp = min(array[3], array[17]);
            array[17] = max(array[3], array[17]);
            array[3] = tmp;
            tmp = min(array[6], array[20]);
            array[20] = max(array[6], array[20]);
            array[6] = tmp;
            tmp = min(array[7], array[21]);
            array[21] = max(array[7], array[21]);
            array[7] = tmp;
            return min(array[10], array[24]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step7<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[24] = max(array[10], array[24]);
            array[10] = tmp;
            tmp = min(array[11], array[25]);
            array[25] = max(array[11], array[25]);
            array[11] = tmp;
            tmp = min(array[14], array[28]);
            array[28] = max(array[14], array[28]);
            array[14] = tmp;
            tmp = min(array[15], array[29]);
            array[29] = max(array[15], array[29]);
            array[15] = tmp;
            tmp = min(array[18], array[32]);
            array[32] = max(array[18], array[32]);
            array[18] = tmp;
            tmp = min(array[19], array[33]);
            array[33] = max(array[19], array[33]);
            array[19] = tmp;
            tmp = min(array[22], array[36]);
            array[36] = max(array[22], array[36]);
            array[22] = tmp;
            tmp = min(array[23], array[37]);
            array[37] = max(array[23], array[37]);
            array[23] = tmp;
            tmp = min(array[26], array[40]);
            array[40] = max(array[26], array[40]);
            array[26] = tmp;
            tmp = min(array[27], array[41]);
            array[41] = max(array[27], array[41]);
            array[27] = tmp;
            tmp = min(array[30], array[44]);
            array[44] = max(array[30], array[44]);
            array[30] = tmp;
            tmp = min(array[31], array[45]);
            array[45] = max(array[31], array[45]);
            array[31] = tmp;
            tmp = min(array[34], array[48]);
            array[48] = max(array[34], array[48]);
            array[34] = tmp;
            tmp = min(array[35], array[49]);
            array[49] = max(array[35], array[49]);
            array[35] = tmp;
            tmp = min(array[38], array[52]);
            array[52] = max(array[38], array[52]);
            array[38] = tmp;
            tmp = min(array[39], array[53]);
            array[53] = max(array[39], array[53]);
            array[39] = tmp;
            tmp = min(array[42], array[56]);
            array[56] = max(array[42], array[56]);
            array[42] = tmp;
            tmp = min(array[43], array[57]);
            array[57] = max(array[43], array[57]);
            array[43] = tmp;
            tmp = min(array[46], array[60]);
            array[60] = max(array[46], array[60]);
            array[46] = tmp;
            tmp = min(array[47], array[61]);
            array[61] = max(array[47], array[61]);
            array[47] = tmp;
            tmp = min(array[50], array[64]);
            array[64] = max(array[50], array[64]);
            array[50] = tmp;
            tmp = min(array[51], array[65]);
            array[65] = max(array[51], array[65]);
            array[51] = tmp;
            tmp = min(array[54], array[68]);
            array[68] = max(array[54], array[68]);
            array[54] = tmp;
            tmp = min(array[55], array[69]);
            array[69] = max(array[55], array[69]);
            array[55] = tmp;
            tmp = min(array[58], array[72]);
            array[72] = max(array[58], array[72]);
            array[58] = tmp;
            tmp = min(array[59], array[73]);
            array[73] = max(array[59], array[73]);
            array[59] = tmp;
            tmp = min(array[62], array[76]);
            array[76] = max(array[62], array[76]);
            array[62] = tmp;
            tmp = min(array[63], array[77]);
            array[77] = max(array[63], array[77]);
            array[63] = tmp;
            tmp = min(array[66], array[80]);
            array[80] = max(array[66], array[80]);
            array[66] = tmp;
            tmp = min(array[2], array[8]);
            array[8] = max(array[2], array[8]);
            array[2] = tmp;
            tmp = min(array[3], array[9]);
            array[9] = max(array[3], array[9]);
            array[3] = tmp;
            tmp = min(array[6], array[12]);
            array[12] = max(array[6], array[12]);
            array[6] = tmp;
            tmp = min(array[7], array[13]);
            array[13] = max(array[7], array[13]);
            array[7] = tmp;
            tmp = min(array[10], array[16]);
            array[16] = max(array[10], array[16]);
            array[10] = tmp;
            tmp = min(array[11], array[17]);
            array[17] = max(array[11], array[17]);
            array[11] = tmp;
            tmp = min(array[14], array[20]);
            array[20] = max(array[14], array[20]);
            array[14] = tmp;
            tmp = min(array[15], array[21]);
            array[21] = max(array[15], array[21]);
            array[15] = tmp;
            tmp = min(array[18], array[24]);
            array[24] = max(array[18], array[24]);
            array[18] = tmp;
            tmp = min(array[19], array[25]);
            array[25] = max(array[19], array[25]);
            array[19] = tmp;
            tmp = min(array[22], array[28]);
            array[28] = max(array[22], array[28]);
            array[22] = tmp;
            tmp = min(array[23], array[29]);
            array[29] = max(array[23], array[29]);
            array[23] = tmp;
            tmp = min(array[26], array[32]);
            array[32] = max(array[26], array[32]);
            array[26] = tmp;
            tmp = min(array[27], array[33]);
            array[33] = max(array[27], array[33]);
            array[27] = tmp;
            tmp = min(array[30], array[36]);
            array[36] = max(array[30], array[36]);
            array[30] = tmp;
            tmp = min(array[31], array[37]);
            array[37] = max(array[31], array[37]);
            array[31] = tmp;
            tmp = min(array[34], array[40]);
            array[40] = max(array[34], array[40]);
            array[34] = tmp;
            tmp = min(array[35], array[41]);
            array[41] = max(array[35], array[41]);
            array[35] = tmp;
            tmp = min(array[38], array[44]);
            array[44] = max(array[38], array[44]);
            array[38] = tmp;
            tmp = min(array[39], array[45]);
            array[45] = max(array[39], array[45]);
            array[39] = tmp;
            tmp = min(array[42], array[48]);
            array[48] = max(array[42], array[48]);
            array[42] = tmp;
            tmp = min(array[43], array[49]);
            array[49] = max(array[43], array[49]);
            array[43] = tmp;
            tmp = min(array[46], array[52]);
            array[52] = max(array[46], array[52]);
            array[46] = tmp;
            tmp = min(array[47], array[53]);
            array[53] = max(array[47], array[53]);
            array[47] = tmp;
            tmp = min(array[50], array[56]);
            array[56] = max(array[50], array[56]);
            array[50] = tmp;
            tmp = min(array[51], array[57]);
            array[57] = max(array[51], array[57]);
            array[51] = tmp;
            tmp = min(array[54], array[60]);
            array[60] = max(array[54], array[60]);
            array[54] = tmp;
            tmp = min(array[55], array[61]);
            array[61] = max(array[55], array[61]);
            array[55] = tmp;
            tmp = min(array[58], array[64]);
            array[64] = max(array[58], array[64]);
            array[58] = tmp;
            tmp = min(array[59], array[65]);
            array[65] = max(array[59], array[65]);
            array[59] = tmp;
            tmp = min(array[62], array[68]);
            array[68] = max(array[62], array[68]);
            array[62] = tmp;
            tmp = min(array[63], array[69]);
            array[69] = max(array[63], array[69]);
            array[63] = tmp;
            tmp = min(array[66], array[72]);
            array[72] = max(array[66], array[72]);
            array[66] = tmp;
            tmp = min(array[67], array[73]);
            array[73] = max(array[67], array[73]);
            array[67] = tmp;
            tmp = min(array[70], array[76]);
            array[76] = max(array[70], array[76]);
            array[70] = tmp;
            tmp = min(array[71], array[77]);
            array[77] = max(array[71], array[77]);
            array[71] = tmp;
            tmp = min(array[74], array[80]);
            array[80] = max(array[74], array[80]);
            array[74] = tmp;
            tmp = min(array[2], array[4]);
            array[4] = max(array[2], array[4]);
            array[2] = tmp;
            tmp = min(array[3], array[5]);
            array[5] = max(array[3], array[5]);
            array[3] = tmp;
            tmp = min(array[6], array[8]);
            array[8] = max(array[6], array[8]);
            array[6] = tmp;
            tmp = min(array[7], array[9]);
            array[9] = max(array[7], array[9]);
            array[7] = tmp;
            tmp = min(array[10], array[12]);
            array[12] = max(array[10], array[12]);
            array[10] = tmp;
            tmp = min(array[11], array[13]);
            array[13] = max(array[11], array[13]);
            array[11] = tmp;
            tmp = min(array[14], array[16]);
            array[16] = max(array[14], array[16]);
            array[14] = tmp;
            tmp = min(array[15], array[17]);
            array[17] = max(array[15], array[17]);
            array[15] = tmp;
            tmp = min(array[18], array[20]);
            array[20] = max(array[18], array[20]);
            array[18] = tmp;
            return min(array[19], array[21]);
        }

        [MethodImpl(MethodImplOptions.NoInlining)]
        static T step8<T>(T tmp, ArrayView<T> array)
              where T : unmanaged, INumber<T>
        {
            array[21] = max(array[19], array[21]);
            array[19] = tmp;
            tmp = min(array[22], array[24]);
            array[24] = max(array[22], array[24]);
            array[22] = tmp;
            tmp = min(array[23], array[25]);
            array[25] = max(array[23], array[25]);
            array[23] = tmp;
            tmp = min(array[26], array[28]);
            array[28] = max(array[26], array[28]);
            array[26] = tmp;
            tmp = min(array[27], array[29]);
            array[29] = max(array[27], array[29]);
            array[27] = tmp;
            tmp = min(array[30], array[32]);
            array[32] = max(array[30], array[32]);
            array[30] = tmp;
            tmp = min(array[31], array[33]);
            array[33] = max(array[31], array[33]);
            array[31] = tmp;
            tmp = min(array[34], array[36]);
            array[36] = max(array[34], array[36]);
            array[34] = tmp;
            tmp = min(array[35], array[37]);
            array[37] = max(array[35], array[37]);
            array[35] = tmp;
            tmp = min(array[38], array[40]);
            array[40] = max(array[38], array[40]);
            array[38] = tmp;
            tmp = min(array[39], array[41]);
            array[41] = max(array[39], array[41]);
            array[39] = tmp;
            tmp = min(array[42], array[44]);
            array[44] = max(array[42], array[44]);
            array[42] = tmp;
            tmp = min(array[43], array[45]);
            array[45] = max(array[43], array[45]);
            array[43] = tmp;
            tmp = min(array[46], array[48]);
            array[48] = max(array[46], array[48]);
            array[46] = tmp;
            tmp = min(array[47], array[49]);
            array[49] = max(array[47], array[49]);
            array[47] = tmp;
            tmp = min(array[50], array[52]);
            array[52] = max(array[50], array[52]);
            array[50] = tmp;
            tmp = min(array[51], array[53]);
            array[53] = max(array[51], array[53]);
            array[51] = tmp;
            tmp = min(array[54], array[56]);
            array[56] = max(array[54], array[56]);
            array[54] = tmp;
            tmp = min(array[55], array[57]);
            array[57] = max(array[55], array[57]);
            array[55] = tmp;
            tmp = min(array[58], array[60]);
            array[60] = max(array[58], array[60]);
            array[58] = tmp;
            tmp = min(array[59], array[61]);
            array[61] = max(array[59], array[61]);
            array[59] = tmp;
            tmp = min(array[62], array[64]);
            array[64] = max(array[62], array[64]);
            array[62] = tmp;
            tmp = min(array[63], array[65]);
            array[65] = max(array[63], array[65]);
            array[63] = tmp;
            tmp = min(array[66], array[68]);
            array[68] = max(array[66], array[68]);
            array[66] = tmp;
            tmp = min(array[67], array[69]);
            array[69] = max(array[67], array[69]);
            array[67] = tmp;
            tmp = min(array[70], array[72]);
            array[72] = max(array[70], array[72]);
            array[70] = tmp;
            tmp = min(array[71], array[73]);
            array[73] = max(array[71], array[73]);
            array[71] = tmp;
            tmp = min(array[74], array[76]);
            array[76] = max(array[74], array[76]);
            array[74] = tmp;
            tmp = min(array[75], array[77]);
            array[77] = max(array[75], array[77]);
            array[75] = tmp;
            tmp = min(array[78], array[80]);
            array[80] = max(array[78], array[80]);
            array[78] = tmp;
            array[1] = max(array[0], array[1]);
            array[3] = max(array[2], array[3]);
            array[5] = max(array[4], array[5]);
            array[7] = max(array[6], array[7]);
            array[9] = max(array[8], array[9]);
            array[11] = max(array[10], array[11]);
            array[13] = max(array[12], array[13]);
            array[15] = max(array[14], array[15]);
            array[17] = max(array[16], array[17]);
            array[19] = max(array[18], array[19]);
            array[21] = max(array[20], array[21]);
            array[23] = max(array[22], array[23]);
            array[25] = max(array[24], array[25]);
            array[27] = max(array[26], array[27]);
            array[29] = max(array[28], array[29]);
            array[31] = max(array[30], array[31]);
            array[33] = max(array[32], array[33]);
            array[35] = max(array[34], array[35]);
            array[37] = max(array[36], array[37]);
            array[39] = max(array[38], array[39]);
            array[40] = min(array[40], array[41]);
            array[42] = min(array[42], array[43]);
            array[44] = min(array[44], array[45]);
            array[46] = min(array[46], array[47]);
            array[48] = min(array[48], array[49]);
            array[50] = min(array[50], array[51]);
            array[52] = min(array[52], array[53]);
            array[54] = min(array[54], array[55]);
            array[56] = min(array[56], array[57]);
            array[58] = min(array[58], array[59]);
            array[60] = min(array[60], array[61]);
            array[62] = min(array[62], array[63]);
            array[64] = min(array[64], array[65]);
            array[66] = min(array[66], array[67]);
            array[68] = min(array[68], array[69]);
            array[70] = min(array[70], array[71]);
            array[72] = min(array[72], array[73]);
            array[74] = min(array[74], array[75]);
            array[76] = min(array[76], array[77]);
            array[78] = min(array[78], array[79]);
            array[64] = max(array[1], array[64]);
            array[66] = max(array[3], array[66]);
            array[68] = max(array[5], array[68]);
            array[70] = max(array[7], array[70]);
            array[9] = min(array[9], array[72]);
            array[11] = min(array[11], array[74]);
            array[13] = min(array[13], array[76]);
            array[15] = min(array[15], array[78]);
            array[17] = min(array[17], array[80]);
            array[40] = max(array[9], array[40]);
            array[42] = max(array[11], array[42]);
            array[44] = max(array[13], array[44]);
            array[46] = max(array[15], array[46]);
            array[48] = max(array[17], array[48]);
            array[50] = max(array[19], array[50]);
            array[52] = max(array[21], array[52]);
            array[54] = max(array[23], array[54]);
            array[25] = min(array[25], array[56]);
            array[27] = min(array[27], array[58]);
            array[29] = min(array[29], array[60]);
            array[31] = min(array[31], array[62]);
            array[33] = min(array[33], array[64]);
            array[35] = min(array[35], array[66]);
            array[37] = min(array[37], array[68]);
            array[39] = min(array[39], array[70]);
            array[40] = max(array[25], array[40]);
            array[42] = max(array[27], array[42]);
            array[44] = max(array[29], array[44]);
            array[46] = max(array[31], array[46]);
            array[33] = min(array[33], array[48]);
            array[35] = min(array[35], array[50]);
            array[37] = min(array[37], array[52]);
            array[39] = min(array[39], array[54]);
            array[40] = max(array[33], array[40]);
            array[42] = max(array[35], array[42]);
            array[37] = min(array[37], array[44]);
            array[39] = min(array[39], array[46]);
            array[40] = max(array[37], array[40]);
            array[39] = min(array[39], array[42]);
            return max(array[39], array[40]);
        }
    }
}
